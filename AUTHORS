Written by Nicolas Delon <nicolas.delon@prelude-ids.com>

Originally written by Markus Alkio and Miika Keskinen.
